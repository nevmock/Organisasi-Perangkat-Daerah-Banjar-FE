'use client';

// import node module libraries
import { Row, Col, Card, Form, Button, Image } from 'react-bootstrap';
import Link from 'next/link';

// import hooks
import useMounted from 'hooks/useMounted';
import toast, { Toaster } from 'node_modules/react-hot-toast/dist';
import Cookies from 'js-cookie';
import request from 'utils/request';
import { useState } from 'react';
import { useRouter } from 'node_modules/next/navigation';

const SignIn = () => {
  const router = useRouter();
  const [loading, setLoading] = useState(false);
  const hasMounted = useMounted();

  const handleSubmit = async (e) => {
    e.preventDefault();
    setLoading(true);
    const data = {
      email: e.target.username.value,
      password: e.target.password.value,
    };
    toast.loading('Loading...');

    try {
      request
        .post('/auth/login', data)
        .then(function (response) {
          console.log('Success:', response.data);
          if (response.status === 200 || response.status === 201) {
            Cookies.set('token', response.data.token);
            toast.dismiss();
            toast.success('Success Login');
            router.push('/');
          } else {
            toast.dismiss();
            toast.error('Failed to login. Please try again.');
            setLoading(false);
          }
        })
        .catch(function (error) {
          const message = error?.response?.data?.message;
          console.log(error);
          toast.dismiss();
          toast.error(message);
          setLoading(false);
        });
    } catch (error) {
      const message = error?.response?.data?.message;
      console.log(error);
      toast.dismiss();
      toast.error(message);
      setLoading(false);
    }
  };

  return (
    <>
      <Toaster position="top-center" />
      <Row className="align-items-center justify-content-center g-0 min-vh-100">
        <Col xxl={4} lg={6} md={8} xs={12} className="py-8 py-xl-0">
          {/* Card */}
          <Card className="smooth-shadow-md">
            {/* Card body */}
            <Card.Body className="p-6">
              <div className="mb-4">
                <Link
                  href="/"
                  className="d-flex align-items-center text-decoration-none"
                >
                  {/* Logo Image */}
                  <img
                    src="/images/logo/logo-banjar.png"
                    alt="Banjar Logo"
                    className="me-2" // margin end (right) 2
                    style={{ height: '60px' }} // sesuaikan tinggi sesuai kebutuhan
                  />
                  <svg
                    width="141"
                    height="19"
                    viewBox="0 0 141 19"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                    className="mb-2"
                  >
                    <path
                      d="M1.69531 18C1.14844 18 0.875 17.707 0.875 17.1211V2.07422C0.875 1.48828 1.14844 1.19531 1.69531 1.19531H5.78516C9.37891 1.19531 11.8086 1.92188 13.0742 3.375C14.3477 4.82812 14.9844 6.89453 14.9844 9.57422C14.9844 12.2539 14.3477 14.3281 13.0742 15.7969C11.8086 17.2656 9.37891 18 5.78516 18H1.69531ZM4.29688 15.0938H5.5625C7.98438 15.0938 9.55078 14.6445 10.2617 13.7461C10.9727 12.8398 11.3281 11.4492 11.3281 9.57422C11.3281 7.69922 10.9727 6.31641 10.2617 5.42578C9.55078 4.52734 7.98438 4.07812 5.5625 4.07812H4.29688V15.0938ZM14.5297 14.7188C14.5297 13.1562 15.2758 12.0234 16.768 11.3203C18.2602 10.6172 19.9633 10.2422 21.8773 10.1953V9.72656C21.8773 9.00781 21.6977 8.5 21.3383 8.20312C20.9789 7.90625 20.4789 7.75781 19.8383 7.75781C19.3852 7.75781 18.9828 7.82422 18.6313 7.95703C18.2875 8.08203 17.9867 8.23047 17.7289 8.40234C17.4789 8.56641 17.2523 8.73438 17.0492 8.90625C16.6898 9.21875 16.393 9.23438 16.1586 8.95312L15.1859 7.75781C14.9438 7.46094 15.0023 7.15625 15.3617 6.84375C15.6352 6.60156 15.9516 6.39062 16.3109 6.21094C16.6781 6.03125 17.1625 5.86328 17.7641 5.70703C18.3656 5.54297 19.1469 5.46094 20.1078 5.46094C21.7328 5.46094 22.9789 5.83594 23.8461 6.58594C24.7211 7.33594 25.1586 8.44141 25.1586 9.90234V17.2969C25.1586 17.7656 24.9242 18 24.4555 18H22.5336C22.1117 18 21.9008 17.7656 21.9008 17.2969V16.9453H21.8773C21.4164 17.3906 20.8617 17.7188 20.2133 17.9297C19.5727 18.1328 18.9828 18.2344 18.4438 18.2344C17.1625 18.2344 16.1898 17.9219 15.5258 17.2969C14.8617 16.6641 14.5297 15.8047 14.5297 14.7188ZM17.9984 14.6484C17.9984 14.9219 18.0531 15.1602 18.1625 15.3633C18.2719 15.5586 18.4438 15.7031 18.6781 15.7969C18.9125 15.8906 19.1742 15.9375 19.4633 15.9375C19.8617 15.9375 20.2484 15.8828 20.6234 15.7734C20.9984 15.6641 21.4164 15.4062 21.8773 15V12.457C20.5648 12.6055 19.6859 12.7969 19.2406 13.0312C18.7953 13.2656 18.475 13.5078 18.2797 13.7578C18.0922 14.0078 17.9984 14.3047 17.9984 14.6484ZM25.7117 17.1797C25.3289 16.9062 25.2234 16.6133 25.3953 16.3008L25.993 15.2109C26.2039 14.8203 26.532 14.7734 26.9773 15.0703C27.4227 15.3672 27.9461 15.5859 28.5477 15.7266C29.157 15.8672 29.7117 15.9375 30.2117 15.9375C30.5633 15.9375 30.8914 15.9023 31.1961 15.832C31.5008 15.7617 31.7586 15.625 31.9695 15.4219C32.1805 15.2188 32.2859 14.9219 32.2859 14.5312C32.2859 14.2969 32.2234 14.0977 32.0984 13.9336C31.9734 13.7695 31.8133 13.6445 31.618 13.5586C31.4227 13.4727 31.2156 13.4023 30.9969 13.3477C30.7078 13.2773 30.2898 13.1602 29.743 12.9961C29.2039 12.832 28.6844 12.6406 28.1844 12.4219C27.7703 12.2422 27.3641 11.9922 26.9656 11.6719C26.575 11.3438 26.2859 10.9805 26.0984 10.582C25.9188 10.1836 25.8289 9.69141 25.8289 9.10547C25.8289 8.31641 26.0555 7.625 26.5086 7.03125C26.9695 6.4375 27.5633 6.02734 28.2898 5.80078C29.0164 5.57422 29.9227 5.46094 31.0086 5.46094C31.743 5.46094 32.4578 5.56641 33.1531 5.77734C33.8484 5.98828 34.3445 6.1875 34.6414 6.375C35.1102 6.67188 35.2273 6.98828 34.993 7.32422L34.2781 8.36719C34.0594 8.67969 33.7078 8.70312 33.2234 8.4375C32.8563 8.23438 32.493 8.07031 32.1336 7.94531C31.782 7.82031 31.3875 7.75781 30.95 7.75781C30.6531 7.75781 30.368 7.78906 30.0945 7.85156C29.8211 7.91406 29.5867 8.03125 29.3914 8.20312C29.2039 8.375 29.1102 8.60156 29.1102 8.88281C29.1102 9.17969 29.1961 9.41406 29.368 9.58594C29.5477 9.75 29.7508 9.87109 29.9773 9.94922C30.2117 10.0273 30.4344 10.1016 30.6453 10.1719C31.0828 10.3125 31.5242 10.4492 31.9695 10.582C32.4148 10.707 32.868 10.8594 33.3289 11.0391C33.7273 11.1953 34.1141 11.418 34.4891 11.707C34.8641 11.9961 35.1375 12.3633 35.3094 12.8086C35.4813 13.2539 35.5672 13.7617 35.5672 14.332C35.5672 15.0898 35.3406 15.793 34.8875 16.4414C34.4344 17.0898 33.8367 17.5508 33.0945 17.8242C32.3523 18.0977 31.4891 18.2344 30.5047 18.2344C29.4031 18.2344 28.4656 18.1562 27.6922 18C26.9188 17.8438 26.2586 17.5703 25.7117 17.1797ZM36.05 18C35.5812 18 35.3469 17.7656 35.3469 17.2969V1.40625C35.3469 0.9375 35.5812 0.703125 36.05 0.703125H37.925C38.3937 0.703125 38.6281 0.9375 38.6281 1.40625V6.14062C38.6281 6.45312 38.6125 6.76562 38.5812 7.07812H38.6516C39.0109 6.46094 39.468 6.03906 40.0227 5.8125C40.5773 5.57812 41.2453 5.46094 42.0266 5.46094C43.2453 5.46094 44.2531 5.84375 45.05 6.60938C45.8469 7.375 46.2453 8.77344 46.2453 10.8047V17.2969C46.2453 17.7656 46.0109 18 45.5422 18H43.6672C43.1984 18 42.9641 17.7656 42.9641 17.2969V11.6484C42.9641 9.94531 42.8469 8.87109 42.6125 8.42578C42.3781 7.98047 41.8742 7.75781 41.1008 7.75781C40.2805 7.75781 39.6633 8.07812 39.2492 8.71875C38.8352 9.35156 38.6281 10.6719 38.6281 12.6797V17.2969C38.6281 17.7656 38.3937 18 37.925 18H36.05ZM47.7125 18C47.2438 18 47.0094 17.7656 47.0094 17.2969V1.40625C47.0094 0.9375 47.2438 0.703125 47.7125 0.703125H49.5875C50.0563 0.703125 50.2906 0.9375 50.2906 1.40625V6.14062C50.2906 6.45312 50.275 6.76562 50.2438 7.07812H50.2906C50.6969 6.40625 51.15 5.96875 51.65 5.76562C52.15 5.5625 52.7516 5.46094 53.4547 5.46094C55.2906 5.46094 56.5797 6.09766 57.3219 7.37109C58.0719 8.63672 58.4469 10.1289 58.4469 11.8477C58.4469 13.5664 58.0719 15.0625 57.3219 16.3359C56.5797 17.6016 55.2906 18.2344 53.4547 18.2344C52.7516 18.2344 52.15 18.1328 51.65 17.9297C51.15 17.7266 50.6969 17.2891 50.2906 16.6172H50.2438L50.1969 17.2969C50.1656 17.7656 49.9547 18 49.5641 18H47.7125ZM50.2906 12.375C50.2906 13.4297 50.4977 14.2891 50.9117 14.9531C51.3336 15.6094 51.8375 15.9375 52.4234 15.9375C53.4781 15.9375 54.1656 15.5703 54.4859 14.8359C54.8141 14.0938 54.9781 13.0977 54.9781 11.8477C54.9781 10.5977 54.8141 9.60547 54.4859 8.87109C54.1656 8.12891 53.4781 7.75781 52.4234 7.75781C51.8375 7.75781 51.3336 8.08984 50.9117 8.75391C50.4977 9.41016 50.2906 10.2656 50.2906 11.3203V12.375ZM57.9219 11.8477C57.9219 9.85547 58.4336 8.29297 59.457 7.16016C60.4883 6.02734 62.0195 5.46094 64.0508 5.46094C66.082 5.46094 67.6094 6.02734 68.6328 7.16016C69.6641 8.29297 70.1797 9.85547 70.1797 11.8477C70.1797 13.8398 69.6641 15.4023 68.6328 16.5352C67.6094 17.668 66.082 18.2344 64.0508 18.2344C62.0195 18.2344 60.4883 17.668 59.457 16.5352C58.4336 15.4023 57.9219 13.8398 57.9219 11.8477ZM61.3906 11.8477C61.3906 13.332 61.6172 14.3867 62.0703 15.0117C62.5312 15.6289 63.1914 15.9375 64.0508 15.9375C64.9102 15.9375 65.5664 15.6289 66.0195 15.0117C66.4805 14.3867 66.7109 13.332 66.7109 11.8477C66.7109 10.3633 66.4805 9.3125 66.0195 8.69531C65.5664 8.07031 64.9102 7.75781 64.0508 7.75781C63.1914 7.75781 62.5312 8.07031 62.0703 8.69531C61.6172 9.3125 61.3906 10.3633 61.3906 11.8477ZM69.6547 14.7188C69.6547 13.1562 70.4008 12.0234 71.893 11.3203C73.3852 10.6172 75.0883 10.2422 77.0023 10.1953V9.72656C77.0023 9.00781 76.8227 8.5 76.4633 8.20312C76.1039 7.90625 75.6039 7.75781 74.9633 7.75781C74.5102 7.75781 74.1078 7.82422 73.7562 7.95703C73.4125 8.08203 73.1117 8.23047 72.8539 8.40234C72.6039 8.56641 72.3773 8.73438 72.1742 8.90625C71.8148 9.21875 71.518 9.23438 71.2836 8.95312L70.3109 7.75781C70.0687 7.46094 70.1273 7.15625 70.4867 6.84375C70.7602 6.60156 71.0766 6.39062 71.4359 6.21094C71.8031 6.03125 72.2875 5.86328 72.8891 5.70703C73.4906 5.54297 74.2719 5.46094 75.2328 5.46094C76.8578 5.46094 78.1039 5.83594 78.9711 6.58594C79.8461 7.33594 80.2836 8.44141 80.2836 9.90234V17.2969C80.2836 17.7656 80.0492 18 79.5805 18H77.6586C77.2367 18 77.0258 17.7656 77.0258 17.2969V16.9453H77.0023C76.5414 17.3906 75.9867 17.7188 75.3383 17.9297C74.6977 18.1328 74.1078 18.2344 73.5687 18.2344C72.2875 18.2344 71.3148 17.9219 70.6508 17.2969C69.9867 16.6641 69.6547 15.8047 69.6547 14.7188ZM73.1234 14.6484C73.1234 14.9219 73.1781 15.1602 73.2875 15.3633C73.3969 15.5586 73.5687 15.7031 73.8031 15.7969C74.0375 15.8906 74.2992 15.9375 74.5883 15.9375C74.9867 15.9375 75.3734 15.8828 75.7484 15.7734C76.1234 15.6641 76.5414 15.4062 77.0023 15V12.457C75.6898 12.6055 74.8109 12.7969 74.3656 13.0312C73.9203 13.2656 73.6 13.5078 73.4047 13.7578C73.2172 14.0078 73.1234 14.3047 73.1234 14.6484ZM81.7859 18C81.3172 18 81.0828 17.7656 81.0828 17.2969V6.39844C81.0828 5.92969 81.3172 5.69531 81.7859 5.69531H83.6375C84.1062 5.69531 84.3406 5.92969 84.3406 6.39844V7.35938H84.3875C84.5906 6.85938 84.9305 6.41797 85.407 6.03516C85.8836 5.65234 86.4461 5.46094 87.0945 5.46094C87.5398 5.46094 87.907 5.51562 88.1961 5.625C88.4695 5.72656 88.575 5.91406 88.5125 6.1875L88.1844 7.58203C88.1141 7.89453 87.9031 7.98828 87.5516 7.86328C87.3484 7.79297 87.1531 7.75781 86.9656 7.75781C86.2156 7.75781 85.5945 8.20703 85.1023 9.10547C84.6102 10.0039 84.3641 11.3125 84.3641 13.0312V17.2969C84.3641 17.7656 84.1297 18 83.6609 18H81.7859ZM87.2375 11.8477C87.2375 10.1289 87.6086 8.63672 88.3508 7.37109C89.1008 6.09766 90.3938 5.46094 92.2297 5.46094C92.9328 5.46094 93.5344 5.5625 94.0344 5.76562C94.5344 5.96875 94.9875 6.40625 95.3938 7.07812H95.4406C95.4094 6.76562 95.3938 6.45312 95.3938 6.14062V1.40625C95.3938 0.9375 95.6281 0.703125 96.0969 0.703125H97.9719C98.4406 0.703125 98.675 0.9375 98.675 1.40625V17.2969C98.675 17.7656 98.4406 18 97.9719 18H96.1203C95.7297 18 95.5188 17.7656 95.4875 17.2969L95.4406 16.6172H95.3938C94.9875 17.2891 94.5344 17.7266 94.0344 17.9297C93.5344 18.1328 92.9328 18.2344 92.2297 18.2344C90.3938 18.2344 89.1008 17.6016 88.3508 16.3359C87.6086 15.0625 87.2375 13.5664 87.2375 11.8477ZM90.7063 11.8477C90.7063 13.0977 90.8664 14.0938 91.1867 14.8359C91.5148 15.5703 92.2063 15.9375 93.2609 15.9375C93.8469 15.9375 94.3469 15.6094 94.7609 14.9531C95.1828 14.2891 95.3938 13.4297 95.3938 12.375V11.3203C95.3938 10.2656 95.1828 9.41016 94.7609 8.75391C94.3469 8.08984 93.8469 7.75781 93.2609 7.75781C92.2063 7.75781 91.5148 8.12891 91.1867 8.87109C90.8664 9.60547 90.7063 10.5977 90.7063 11.8477ZM105.746 16.7461C105.262 16.3789 105.145 16.0078 105.395 15.6328L106.297 14.2734C106.594 13.8281 107.027 13.8047 107.598 14.2031C108.035 14.5078 108.605 14.8242 109.309 15.1523C110.02 15.4727 110.766 15.6328 111.547 15.6328C112.094 15.6328 112.621 15.5703 113.129 15.4453C113.637 15.3203 114.023 15.0781 114.289 14.7188C114.555 14.3594 114.688 13.9336 114.688 13.4414C114.688 13.0898 114.629 12.7812 114.512 12.5156C114.395 12.25 114.203 12.0312 113.938 11.8594C113.672 11.6875 113.398 11.543 113.117 11.4258C112.625 11.2227 112.004 11.0234 111.254 10.8281C110.512 10.625 109.777 10.3828 109.051 10.1016C108.402 9.85156 107.809 9.50781 107.27 9.07031C106.73 8.63281 106.312 8.14062 106.016 7.59375C105.719 7.04688 105.57 6.31641 105.57 5.40234C105.57 4.31641 105.922 3.38672 106.625 2.61328C107.328 1.83984 108.137 1.34375 109.051 1.125C109.965 0.90625 110.887 0.796875 111.816 0.796875C112.738 0.796875 113.688 0.9375 114.664 1.21875C115.648 1.5 116.391 1.85156 116.891 2.27344C117.383 2.6875 117.504 3.0625 117.254 3.39844L116.305 4.67578C115.984 5.11328 115.555 5.14844 115.016 4.78125C114.672 4.54688 114.199 4.28516 113.598 3.99609C113.004 3.70703 112.383 3.5625 111.734 3.5625C111.273 3.5625 110.848 3.60156 110.457 3.67969C110.074 3.75781 109.734 3.94531 109.438 4.24219C109.141 4.53906 108.992 4.90625 108.992 5.34375C108.992 5.76562 109.102 6.10938 109.32 6.375C109.539 6.63281 109.781 6.82812 110.047 6.96094C110.312 7.08594 110.582 7.19141 110.855 7.27734C111.699 7.55078 112.453 7.79297 113.117 8.00391C113.781 8.20703 114.395 8.43359 114.957 8.68359C115.738 9.03516 116.336 9.38672 116.75 9.73828C117.164 10.0898 117.504 10.5703 117.77 11.1797C118.043 11.7891 118.18 12.5156 118.18 13.3594C118.18 14.6094 117.781 15.6445 116.984 16.4648C116.188 17.2773 115.301 17.8008 114.324 18.0352C113.355 18.2773 112.41 18.3984 111.488 18.3984C110.129 18.3984 109.023 18.2656 108.172 18C107.32 17.7422 106.512 17.3242 105.746 16.7461ZM120.495 18C119.948 18 119.675 17.707 119.675 17.1211V2.07422C119.675 1.48828 119.948 1.19531 120.495 1.19531H122.277C122.823 1.19531 123.097 1.48828 123.097 2.07422V17.1211C123.097 17.707 122.823 18 122.277 18H120.495ZM125.12 18C124.557 18 124.373 17.7422 124.569 17.2266L130.311 2.14453C130.553 1.51172 130.92 1.19531 131.412 1.19531H133.053C133.545 1.19531 133.912 1.51172 134.155 2.14453L139.897 17.2266C140.092 17.7422 139.909 18 139.346 18H137.483C136.967 18 136.608 17.7305 136.405 17.1914L135.209 14.0391H129.256L128.061 17.1914C127.858 17.7305 127.498 18 126.983 18H125.12ZM130.346 11.1328H134.12L132.678 7.40625C132.506 6.96875 132.401 6.65234 132.362 6.45703C132.33 6.25391 132.295 5.95703 132.256 5.56641H132.209C132.17 5.95703 132.131 6.25391 132.092 6.45703C132.061 6.65234 131.959 6.96875 131.787 7.40625L130.346 11.1328Z"
                      fill="black"
                    />
                  </svg>
                </Link>
                <p className="mb-6">Tolong masukan informasi anda.</p>
              </div>
              {/* Form */}
              {hasMounted && (
                <Form onSubmit={handleSubmit}>
                  {/* Username */}
                  <Form.Group className="mb-3" controlId="username">
                    <Form.Label>Email</Form.Label>
                    <Form.Control
                      type="email"
                      name="username"
                      placeholder="Masukan email anda"
                      required=""
                    />
                  </Form.Group>

                  {/* Password */}
                  <Form.Group className="mb-3" controlId="password">
                    <Form.Label>Password</Form.Label>
                    <Form.Control
                      type="password"
                      name="password"
                      placeholder="**************"
                      required=""
                    />
                  </Form.Group>

                  {/* Checkbox */}
                  {/* <div className="d-lg-flex justify-content-between align-items-center mb-4">
                    <Form.Check type="checkbox" id="rememberme">
                      <Form.Check.Input type="checkbox" />
                      <Form.Check.Label>Remember me</Form.Check.Label>
                    </Form.Check>
                  </div> */}
                  <div>
                    {/* Button */}
                    <div className="d-grid">
                      <Button
                        variant="primary"
                        type="submit"
                        className="text-white"
                      >
                        Masuk
                      </Button>
                    </div>
                    <div className="d-md-flex justify-content-between mt-4">
                      <div className="mb-2 mb-md-0">
                        <Link href="/sign-up" className="fs-5">
                          Belum punya akun? Register{' '}
                        </Link>
                      </div>
                    </div>
                  </div>
                </Form>
              )}
            </Card.Body>
          </Card>
        </Col>
      </Row>
    </>
  );
};

export default SignIn;
